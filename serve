#! /bin/sh
# serve

export DOCKER_HOST=unix:///run/user/$UID/podman/podman.sock

docker-compose() {
	$HOME/.local/bin/docker-compose $@
}

git pull

usage() {
	echo "Usage: $0 []"
	echo
	exit 1
}

while getopts "" opt; do
	case $opt in
		*) usage ;;
	esac
done

if [ "$(docker-compose ps -q)" ]; then
	podman compose build
	docker-compose up -d --force-recreate web-user
	docker-compose up -d --force-recreate web-admin
else
	docker-compose up -d
fi

